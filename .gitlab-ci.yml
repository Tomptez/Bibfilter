---
image: dokku/ci-docker-image

stages:
  - deploy

variables:
  GIT_DEPTH: 0

deploy:
  stage: deploy
  only:
    - deploy
  variables:
    GIT_REMOTE_URL: "$GIT_REMOTE_URL"
    # enable verbose git output
    GIT_PUSH_FLAGS: '-vvv'
    # enable verbose ssh output
    GIT_SSH_COMMAND: 'ssh -vvv'
    # specify `--force` as a flag for git pushes
    GIT_PUSH_FLAGS: '--force'
  script: dokku-deploy
  after_script: [dokku-unlock]
  interruptible: true